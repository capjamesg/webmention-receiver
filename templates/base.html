<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>{% if get_flashed_messages() %}Send Webmention Form Error - {% endif %}{% if title %}{{ title }}{% else %}Webmention Feed{% endif %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />

    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" />

    <link rel="webmention" href="https://webmention.jamesg.blog/endpoint" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <style id="darkmode" media="all">
      html, .citation_box, details, summary, .social li {
        background-color: #1F2937;
      }
      a {
        color: lightgreen;
        border-bottom: 2px dotted lightgreen;
      }
      a:hover {
        color: #ccc;
      }
      h1, h2, h3 {
        color: orange;
      }
      .social_interaction, .webmention {
        background: none;
      }
      p, li, dt, dd, .indieweb_footer, input, label {
        color: white;
      }
      input, textarea {
        background-color: #0c2548;
        color: #ccc;
      }
    </style>
  </head>
  <body>
    <main>
      <a href="#main" class="accessibility_label">Skip to main content</a>
      <nav id="top_navigation">
        <p><a href="/">Webmention Endpoint</a></p>
        {% if session.get("me") %}
        <ul>
          <li><a href="/send">Send a Webmention</a></li>
          <li><a href="/sent">Sent Webmentions</a></li>
          <li><a href="/vouch">Vouch Settings</a></li>
          <li><a href="/stats">Statistics</a></li>
          <li><a href="/logout">Logout</a></li>
        </ul>
        {% else %}
        <ul>
          <li><a href="/login">Login</a></li>
        </ul>
        {% endif %}
      </nav>
      <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.getElementById('darkmode').media = "all";
        }

        if (localStorage.getItem('darkmode') == "true") {
          document.getElementById('darkmode').media = "all";
        } else if (localStorage.getItem('darkmode') == "false") {
          document.getElementById('darkmode').media = "none";
        }

        var navigation = document.getElementById("top_navigation");
        var ul = navigation.getElementsByTagName("ul")[0];
        
        var li = document.createElement("li");
        var dark_style = document.getElementById("darkmode");
  
        if (dark_style.media === "all") {
          li.innerHTML = "<a onclick='toggleTheme();'>Light Mode</a>";
        } else {
          li.innerHTML = "<a onclick='toggleTheme();'>Dark Mode</a>";
        }

        ul.appendChild(li);
  
        function toggleTheme() {
          if (dark_style.media === "all") {
            dark_style.media = "none";
            li.innerHTML = "<a onclick='toggleTheme();'>Dark Mode</a>";
            localStorage.setItem('darkmode', 'false');
          } else {
            dark_style.media = "all";
            li.innerHTML = "<a onclick='toggleTheme();'>Light Mode</a>";
            localStorage.setItem('darkmode', 'true');
          }
        }
      </script>
      <div id="main">
        {% block content %}
        {% endblock %}
      </div>
      {% if config.SHOW_SETUP == True or session.get("me") %}
      <footer>
        <ul>
          {% if config.SHOW_SETUP == True %}
            <li><a href="/setup">Setup Instructions</a></li>
          {% endif %}
          {% if session.get("me") %}
            <li><a href="/received">Received (JSON)</a></li>
            <li><a href="/sent/json">Sent (JSON)</a></li>
            <li><a href="/rss">RSS Feed</a></li>
          {% endif %}
        </ul>
      </footer>
      {% endif %}
      <p class="accessibility_label"><a href="#main">Go Back to the Top</a></p>
    </main>
  </body>
</html>